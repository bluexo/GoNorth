(function(n){"use strict";(function(){typeof ko!="undefined"&&(ko.bindingHandlers.colorpicker={init:function(n,t){jQuery(n).colorpicker({format:"hex"});var i=t();if(ko.isObservable(i))jQuery(n).on("changeColor",function(n){i(n.color.toHex())})},update:function(n,t){var i=ko.utils.unwrapObservable(t());jQuery(n).colorpicker("setValue",i)}})})(n.BindingHandlers=n.BindingHandlers||{})})(window.GoNorth=window.GoNorth||{}),function(n){"use strict";(function(t){(function(t){var i=/#[0-9a-fA-F]{6}/i;t.TaskTypeList=function(n,t,i,r,u,f,e,o,s,h,c){this.title=n;this.createDialogTitle=t;this.editDialogTitle=i;this.createNewButtonLabel=r;this.taskWithoutTypeExistsText=u;this.loadingApiFunction=f;this.anyTaskWithOutTypeApiFunction=e;this.createApiFunction=o;this.updateApiFunction=s;this.deleteApiFunction=h;this.lockCategory=c;this.taskTypes=new ko.observableArray;this.isExpanded=new ko.observable(!0);this.showCreateEditTaskTypeDialog=new ko.observable(!1);this.isEditingTaskType=new ko.observable(!1);this.createEditTaskTypeDialogTitle=new ko.observable(!1);this.createEditTaskTypeName=new ko.observable("");this.createEditTaskTypeColor=new ko.observable("");this.createEditTaskTypeIsDefault=new ko.observable(!1);this.createEditTaskShowColorValidationError=new ko.observable(!1);this.taskTypeToEdit=null;this.showDeleteTaskTypeDialog=new ko.observable(!1);this.taskTypeToDelete=new ko.observable(null);this.taskTypeToRemapDelete=new ko.observable(null);this.taskTypesForRemapping=new ko.pureComputed(function(){var t=this.taskTypes(),r=this.taskTypeToDelete(),i,n;if(!r)return t;for(i=[],n=0;n<t.length;++n)t[n].id!=r.id&&i.push(t[n]);return i},this);this.disableDeleteButton=new ko.pureComputed(function(){var n=this.isLoading(),t=this.taskTypeToRemapDelete(),i=this.taskTypesForRemapping(),r=this.isDialogLocked();return r||n||!t&&i.length>0},this);this.anyTaskWithoutType=new ko.observable(!1);this.isDialogLocked=new ko.observable(!1);this.dialogLockedByUser=new ko.observable("");var l=this;this.showCreateEditTaskTypeDialog.subscribe(function(n){n||l.releaseLock()});this.showDeleteTaskTypeDialog.subscribe(function(n){n||l.releaseLock()});this.isLoading=new ko.observable(!1);this.errorOccured=new ko.observable(!1)};t.TaskTypeList.prototype={toogleVisibility:function(){this.isExpanded(!this.isExpanded())},loadTypes:function(){this.errorOccured(!1);this.isLoading(!0);var n=this;jQuery.ajax({url:"/api/TaskApi/"+this.loadingApiFunction,type:"GET"}).done(function(t){for(var r=[],i=0;i<t.length;++i)t[i].id&&r.push(t[i]);n.taskTypes(r);n.isLoading(!1)}).fail(function(){n.errorOccured(!0);n.isLoading(!1)})},loadAnyTaskWithoutType:function(){var n=this;jQuery.ajax({url:"/api/TaskApi/"+this.anyTaskWithOutTypeApiFunction,type:"GET"}).done(function(t){n.anyTaskWithoutType(t)}).fail(function(){n.errorOccured(!0)})},openNewTaskTypeDialog:function(){this.isEditingTaskType(!1);this.createEditTaskTypeDialogTitle(this.createDialogTitle);this.createEditTaskTypeName("");this.createEditTaskTypeColor("#FFFFFF");this.createEditTaskTypeIsDefault(!1);this.taskTypeToEdit=null;this.openSharedCreateEditTaskTypeDialog();this.releaseLock()},openEditTaskTypeDialog:function(n){this.isEditingTaskType(!0);this.createEditTaskTypeDialogTitle(this.editDialogTitle);this.createEditTaskTypeName(n.name);this.createEditTaskTypeColor(n.color);this.createEditTaskTypeIsDefault(n.isDefault);this.taskTypeToEdit=n;this.openSharedCreateEditTaskTypeDialog();this.acquireLock(n.id)},openSharedCreateEditTaskTypeDialog:function(){this.showCreateEditTaskTypeDialog(!0);n.Util.setupValidation("#gn-taskTypeCreateEditForm")},saveTaskType:function(){var r=!1,u,f,t;(i.test(this.createEditTaskTypeColor())||(r=!0),this.createEditTaskShowColorValidationError(r),jQuery("#gn-taskTypeCreateEditForm").valid()&&!r)&&(u="/api/TaskApi/"+this.createApiFunction,this.taskTypeToEdit&&(u="/api/TaskApi/"+this.updateApiFunction+"?id="+this.taskTypeToEdit.id),f={name:this.createEditTaskTypeName(),color:this.createEditTaskTypeColor(),isDefault:this.createEditTaskTypeIsDefault()},this.errorOccured(!1),this.isLoading(!0),t=this,jQuery.ajax({url:u,headers:n.Util.generateAntiForgeryHeader(),data:JSON.stringify(f),type:"POST",contentType:"application/json"}).done(function(){t.isLoading(!1);t.loadTypes();t.cancelCreateEditTaskTypeDialog()}).fail(function(){t.isLoading(!1);t.errorOccured(!0)}))},cancelCreateEditTaskTypeDialog:function(){this.showCreateEditTaskTypeDialog(!1)},openDeleteTaskTypeDialog:function(n){this.taskTypeToDelete(n);this.taskTypeToRemapDelete(null);this.showDeleteTaskTypeDialog(!0);this.acquireLock(n.id)},deleteTaskType:function(){var i="/api/TaskApi/"+this.deleteApiFunction+"?id="+this.taskTypeToDelete().id,t;this.taskTypeToRemapDelete()&&(i+="&newTaskTypeId="+this.taskTypeToRemapDelete());t=this;this.isLoading(!0);this.errorOccured(!1);jQuery.ajax({url:i,headers:n.Util.generateAntiForgeryHeader(),type:"DELETE"}).done(function(){t.isLoading(!1);t.loadTypes();t.cancelDeleteTaskTypeDialog()}).fail(function(){t.isLoading(!1);t.errorOccured(!0)})},cancelDeleteTaskTypeDialog:function(){this.showDeleteTaskTypeDialog(!1)},releaseLock:function(){this.isDialogLocked(!1);this.dialogLockedByUser("");n.LockService.releaseCurrentLock()},acquireLock:function(t){this.releaseLock();var i=this;n.LockService.acquireLock(this.lockCategory,t).done(function(n,t){n&&(i.isDialogLocked(!0),i.dialogLockedByUser(t))}).fail(function(){i.errorOccured(!0)})}}})(t.ManageTaskTypes=t.ManageTaskTypes||{})})(n.Task=n.Task||{})}(window.GoNorth=window.GoNorth||{}),function(n){"use strict";(function(t){(function(t){t.ViewModel=function(){this.taskGroupTypeList=new t.TaskTypeList(n.Task.ManageTaskTypes.Localization.TaskGroupTypes,n.Task.ManageTaskTypes.Localization.CreateNewTaskGroupType,n.Task.ManageTaskTypes.Localization.EditTaskGroupType,n.Task.ManageTaskTypes.Localization.CreateNewTaskGroupType,n.Task.ManageTaskTypes.Localization.TaskGroupsWithoutTypeExist,"GetTaskGroupTypes","AnyTaskBoardHasTaskGroupsWithoutType","CreateTaskGroupType","UpdateTaskGroupType","DeleteTaskGroupType","TaskGroupType");this.taskTypeList=new t.TaskTypeList(n.Task.ManageTaskTypes.Localization.TaskTypes,n.Task.ManageTaskTypes.Localization.CreateNewTaskType,n.Task.ManageTaskTypes.Localization.EditTaskType,n.Task.ManageTaskTypes.Localization.CreateNewTaskType,n.Task.ManageTaskTypes.Localization.TasksWithoutTypeExist,"GetTaskTypes","AnyTaskBoardHasTasksWithoutType","CreateTaskType","UpdateTaskType","DeleteTaskType","TaskType");this.taskGroupTypeList.loadTypes();this.taskGroupTypeList.loadAnyTaskWithoutType();this.taskTypeList.loadTypes();this.taskTypeList.loadAnyTaskWithoutType()};t.ViewModel.prototype={}})(t.ManageTaskTypes=t.ManageTaskTypes||{})})(n.Task=n.Task||{})}(window.GoNorth=window.GoNorth||{});