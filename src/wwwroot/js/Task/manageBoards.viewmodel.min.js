(function(n){"use strict";(function(n){(function(n){var t=20;n.TaskBoardList=function(n,t,i,r,u,f,e){this.apiMethod=r;this.title=n;this.toogleStatusIcon=t;this.toogleStatusToolTip=i;this.isExpanded=new ko.observable(u);this.boards=new ko.observableArray;this.hasMore=new ko.observable(!1);this.currentPage=new ko.observable(0);this.isLoading=new ko.observable(!1);this.prevLoading=new ko.observable(!1);this.nextLoading=new ko.observable(!1);this.getCategoryNameFunction=f;this.errorOccured=e};n.TaskBoardList.prototype={toogleVisibility:function(){this.isExpanded(!this.isExpanded())},loadBoards:function(){this.errorOccured(!1);this.isLoading(!0);var n=this;jQuery.ajax({url:"/api/TaskApi/"+this.apiMethod+"?start="+this.currentPage()*t+"&pageSize="+t,type:"GET"}).done(function(t){for(var i=0;i<t.boards.length;++i)t.boards[i].categoryName=new ko.pureComputed(function(){return n.getCategoryNameFunction(this.categoryId)},t.boards[i]);n.boards(t.boards);n.hasMore(t.hasMore);n.resetLoadingState()}).fail(function(){n.errorOccured(!0);n.resetLoadingState()})},resetLoadingState:function(){this.isLoading(!1);this.prevLoading(!1);this.nextLoading(!1)},prevPage:function(){this.currentPage(this.currentPage()-1);this.prevLoading(!0);this.loadBoards()},nextPage:function(){this.currentPage(this.currentPage()+1);this.nextLoading(!0);this.loadBoards()}}})(n.ManageBoards=n.ManageBoards||{})})(n.Task=n.Task||{})})(window.GoNorth=window.GoNorth||{}),function(n){"use strict";(function(t){(function(t){t.TaskBoardCategoryList=function(n,t){this.isExpanded=new ko.observable(!1);this.boardCategories=new ko.observableArray;this.showCreateEditCategoryDialog=new ko.observable(!1);this.showCreateEditCategoryName=new ko.observable("");this.showCreateEditCategoryExpandedByDefault=new ko.observable(!1);this.isEditingCategory=new ko.observable(!1);this.categoryToEdit=null;this.showConfirmDeleteDialog=new ko.observable(!1);this.isCategoryToDeleteUsedByBoard=new ko.observable(!1);this.categoryToDelete=null;this.isLoading=new ko.observable(!1);this.reloadBoardsFunc=n;this.errorOccured=t};t.TaskBoardCategoryList.prototype={toogleVisibility:function(){this.isExpanded(!this.isExpanded())},loadBoardCategories:function(){this.errorOccured(!1);this.isLoading(!0);var n=this;jQuery.ajax({url:"/api/TaskApi/GetTaskBoardCategories",type:"GET"}).done(function(t){n.boardCategories(t);n.isLoading(!1)}).fail(function(){n.errorOccured(!0);n.isLoading(!1)})},openNewBoardCategoryDialog:function(){this.showCreateEditCategoryName("");this.showCreateEditCategoryExpandedByDefault(!1);this.isEditingCategory(!1);this.categoryToEdit=null;this.openEditBoardCategoryDialogShared()},openEditBoardCategoryDialog:function(n){this.showCreateEditCategoryName(n.name);this.showCreateEditCategoryExpandedByDefault(n.isExpandedByDefault);this.isEditingCategory(!0);this.categoryToEdit=n;this.openEditBoardCategoryDialogShared()},openEditBoardCategoryDialogShared:function(){this.showCreateEditCategoryDialog(!0);n.Util.setupValidation("#gn-taskBoardCategoryCreateEditForm")},saveBoardCategory:function(){var i,r,t;jQuery("#gn-taskBoardCategoryCreateEditForm").valid()&&(i="/api/TaskApi/CreateTaskBoardCategory",this.categoryToEdit&&(i="/api/TaskApi/UpdateTaskBoardCategory?id="+this.categoryToEdit.id),r={name:this.showCreateEditCategoryName(),isExpandedByDefault:this.showCreateEditCategoryExpandedByDefault()},this.isLoading(!0),this.errorOccured(!1),t=this,jQuery.ajax({url:i,headers:n.Util.generateAntiForgeryHeader(),data:JSON.stringify(r),type:"POST",contentType:"application/json"}).done(function(){t.isLoading(!1);t.loadBoardCategories();t.cancelBoardCategoryDialog()}).fail(function(){t.isLoading(!1);t.errorOccured(!0)}))},cancelBoardCategoryDialog:function(){this.showCreateEditCategoryDialog(!1);this.categoryToEdit=null},openDeleteBoardCategoryDialog:function(n){this.isCategoryToDeleteUsedByBoard(!1);this.showConfirmDeleteDialog(!0);this.categoryToDelete=n;this.checkCategoryIsUsedByBoard(n)},checkCategoryIsUsedByBoard:function(n){this.errorOccured(!1);this.isLoading(!0);var t=this;jQuery.ajax({url:"/api/TaskApi/IsTaskBoardCategoryUsedByBoard?id="+n.id,type:"GET"}).done(function(n){t.isCategoryToDeleteUsedByBoard(n);t.isLoading(!1)}).fail(function(){t.errorOccured(!0);t.isLoading(!1)})},deleteBoardCategory:function(){this.errorOccured(!1);this.isLoading(!0);var t=this;jQuery.ajax({headers:n.Util.generateAntiForgeryHeader(),url:"/api/TaskApi/DeleteTaskBoardCategory?id="+this.categoryToDelete.id,type:"DELETE"}).done(function(){t.isLoading(!1);t.closeConfirmDeleteBoardCategoryDialog();t.loadBoardCategories();t.isCategoryToDeleteUsedByBoard()&&t.reloadBoardsFunc()}).fail(function(){t.errorOccured(!0);t.isLoading(!1)})},closeConfirmDeleteBoardCategoryDialog:function(){this.showConfirmDeleteDialog(!1);this.categoryToDelete=null}}})(t.ManageBoards=t.ManageBoards||{})})(n.Task=n.Task||{})}(window.GoNorth=window.GoNorth||{}),function(n){"use strict";(function(t){(function(t){t.ViewModel=function(){this.isLoading=new ko.observable(!1);this.errorOccured=new ko.observable(!1);this.additionalErrorDetails=new ko.observable("");this.openBoardList=new t.TaskBoardList(n.Task.ManageBoards.Localization.OpenTaskBoards,"glyphicon-ok",n.Task.ManageBoards.Localization.CloseTaskBoardToolTip,"GetOpenTaskBoards",!0,this.getBoardCategoryNameById.bind(this),this.errorOccured);this.closedBoardList=new t.TaskBoardList(n.Task.ManageBoards.Localization.ClosedTaskBoards,"glyphicon-repeat",n.Task.ManageBoards.Localization.ReopenTaskBoardToolTip,"GetClosedTaskBoards",!1,this.getBoardCategoryNameById.bind(this),this.errorOccured);this.showBoardCreateEditDialog=new ko.observable(!1);this.showDateValidationError=new ko.observable(!1);this.isEditingBoard=new ko.observable(!1);this.createEditBoardName=new ko.observable("");this.createEditBoardCategory=new ko.observable(null);this.createEditBoardPlannedStart=new ko.observable(null);this.createEditBoardPlannedEnd=new ko.observable(null);this.editingBoard=null;this.showConfirmDeleteDialog=new ko.observable(!1);this.deleteBoardId=null;this.showConfirmToogleStatusDialog=new ko.observable(!1);this.isToogleStatusClosing=new ko.observable(!1);this.toogleStatusBoardId=null;this.taskBoardCategoryList=new t.TaskBoardCategoryList(this.reloadBoards.bind(this),this.errorOccured);this.taskBoardCategoryList.loadBoardCategories();this.openBoardList.loadBoards();this.closedBoardList.loadBoards()};t.ViewModel.prototype={resetErrorState:function(){this.errorOccured(!1);this.additionalErrorDetails("")},buildTaskBoardUrl:function(n){return"/Task?id="+n.id},getBoardCategoryById:function(n){var i,t;if(!n)return null;for(i=this.taskBoardCategoryList.boardCategories(),t=0;t<i.length;++t)if(i[t].id==n)return i[t];return null},getBoardCategoryNameById:function(n){var t=this.getBoardCategoryById(n);return t?t.name:""},openNewBoardDialog:function(){this.isEditingBoard(!1);this.createEditBoardName("");this.createEditBoardCategory(null);this.createEditBoardPlannedStart(null);this.createEditBoardPlannedEnd(null);this.editingBoard=null;this.openBoardDialogShared()},openEditBoardDialog:function(n){this.isEditingBoard(!0);this.createEditBoardName(n.name);this.createEditBoardCategory(this.getBoardCategoryById(n.categoryId));this.createEditBoardPlannedStart(n.plannedStart?n.plannedStart:null);this.createEditBoardPlannedEnd(n.plannedEnd?n.plannedEnd:null);this.editingBoard=n;this.openBoardDialogShared()},openBoardDialogShared:function(){this.showBoardCreateEditDialog(!0);this.showDateValidationError(!1);n.Util.setupValidation("#gn-taskBoardCreateEditForm")},saveBoard:function(){var i,r,t;if(jQuery("#gn-taskBoardCreateEditForm").valid()){if(!this.createEditBoardPlannedStart()&&this.createEditBoardPlannedEnd()||this.createEditBoardPlannedStart()&&this.createEditBoardPlannedEnd()&&this.createEditBoardPlannedStart()>this.createEditBoardPlannedEnd()){this.showDateValidationError(!0);return}this.showDateValidationError(!1);i="/api/TaskApi/CreateTaskBoard";this.editingBoard&&(i="/api/TaskApi/UpdateTaskBoard?id="+this.editingBoard.id);r={name:this.createEditBoardName(),categoryId:this.createEditBoardCategory()?this.createEditBoardCategory().id:null,plannedStart:this.createEditBoardPlannedStart(),plannedEnd:this.createEditBoardPlannedEnd()};this.isLoading(!0);this.resetErrorState();t=this;jQuery.ajax({url:i,headers:n.Util.generateAntiForgeryHeader(),data:JSON.stringify(r),type:"POST",contentType:"application/json"}).done(function(){t.isLoading(!1);t.editingBoard&&t.editingBoard.isClosed?t.closedBoardList.loadBoards():t.openBoardList.loadBoards();t.cancelBoardDialog()}).fail(function(){t.isLoading(!1);t.errorOccured(!0)})}},cancelBoardDialog:function(){this.editingBoard=null;this.showBoardCreateEditDialog(!1)},openDeleteBoardDialog:function(n){this.showConfirmDeleteDialog(!0);this.deleteBoardId=n.id},deleteBoard:function(){var t=this;this.isLoading(!0);this.resetErrorState();jQuery.ajax({url:"/api/TaskApi/DeleteTaskBoard?id="+this.deleteBoardId,headers:n.Util.generateAntiForgeryHeader(),type:"DELETE"}).done(function(){t.isLoading(!1);t.openBoardList.loadBoards();t.closedBoardList.loadBoards()}).fail(function(n){t.isLoading(!1);t.errorOccured(!0);n.status==400&&n.responseText&&t.additionalErrorDetails(n.responseText)});this.closeConfirmDeleteDialog()},closeConfirmDeleteDialog:function(){this.showConfirmDeleteDialog(!1);this.deleteBoardId=null},openToogleBoardStatusDialog:function(n){this.showConfirmToogleStatusDialog(!0);this.isToogleStatusClosing(!n.isClosed);this.toogleStatusBoardId=n.id},toogleBoardStatus:function(){var t=this;this.isLoading(!0);this.resetErrorState();jQuery.ajax({url:"/api/TaskApi/SetTaskBoardStatus?id="+this.toogleStatusBoardId+"&closed="+this.isToogleStatusClosing(),headers:n.Util.generateAntiForgeryHeader(),type:"POST"}).done(function(){t.isLoading(!1);t.openBoardList.loadBoards();t.closedBoardList.loadBoards()}).fail(function(){t.isLoading(!1);t.errorOccured(!0)});this.closeConfirmToogleStatusDialog()},closeConfirmToogleStatusDialog:function(){this.showConfirmToogleStatusDialog(!1);this.toogleStatusBoardId=null},reloadBoards:function(){this.openBoardList.loadBoards();this.closedBoardList.loadBoards()}}})(t.ManageBoards=t.ManageBoards||{})})(n.Task=n.Task||{})}(window.GoNorth=window.GoNorth||{});