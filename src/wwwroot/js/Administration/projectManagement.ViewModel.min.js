(function(n){"use strict";(function(t){(function(t){t.ViewModel=function(){this.projects=new ko.observableArray;this.showConfirmDeleteDialog=new ko.observable(!1);this.deleteErrorOccured=new ko.observable(!1);this.deleteErrorAdditionalDetails=new ko.observable("");this.deleteProjectId="";this.showProjectCreateEditDialog=new ko.observable(!1);this.createEditName=new ko.observable;this.createEditIsDefault=new ko.observable;this.createEditDialogErrorOccured=new ko.observable(!1);this.editProjectId=new ko.observable("");this.dialogLoading=new ko.observable(!1);this.errorOccured=new ko.observable(!1);this.loadProjects()};t.ViewModel.prototype={loadProjects:function(){var n=this;jQuery.ajax("/api/ProjectApi/Entries").done(function(t){n.projects(t)}).fail(function(){n.errorOccured(!0)})},openCreateProjectDialog:function(){this.showProjectCreateEditDialog(!0);this.createEditName("");this.createEditIsDefault(!1);this.resetSharedCreateEditDialog();this.editProjectId("")},openEditProjectDialog:function(n){this.showProjectCreateEditDialog(!0);this.createEditName(n.name);this.createEditIsDefault(n.isDefault);this.resetSharedCreateEditDialog();this.editProjectId(n.id)},resetSharedCreateEditDialog:function(){this.createEditDialogErrorOccured(!1);this.dialogLoading(!1);n.Util.setupValidation("#gn-projectCreateEditForm")},closeCreateEditProjectDialog:function(){this.showProjectCreateEditDialog(!1);this.dialogLoading(!1)},saveProject:function(){var r,i,t;jQuery("#gn-projectCreateEditForm").valid()&&(r={Name:this.createEditName(),IsDefault:this.createEditIsDefault()},i="/api/ProjectApi/CreateProject",this.editProjectId()&&(i="/api/ProjectApi/UpdateProject?id="+this.editProjectId()),t=this,this.dialogLoading(!0),jQuery.ajax({url:i,headers:n.Util.generateAntiForgeryHeader(),data:JSON.stringify(r),type:"POST",contentType:"application/json"}).done(function(){t.closeCreateEditProjectDialog();t.loadProjects()}).fail(function(){t.dialogLoading(!1);t.createEditDialogErrorOccured(!0)}))},openDeleteProjectDialog:function(n){this.showConfirmDeleteDialog(!0);this.deleteErrorOccured(!1);this.deleteErrorAdditionalDetails("");this.dialogLoading(!1);this.deleteProjectId=n.id},closeConfirmDeleteDialog:function(){this.showConfirmDeleteDialog(!1);this.dialogLoading(!1);this.deleteProjectId=""},deleteProject:function(){var t=this;this.dialogLoading(!0);jQuery.ajax({url:"/api/ProjectApi/DeleteProject?id="+this.deleteProjectId,headers:n.Util.generateAntiForgeryHeader(),type:"DELETE"}).done(function(){t.closeConfirmDeleteDialog();t.loadProjects()}).fail(function(n){t.dialogLoading(!1);t.deleteErrorOccured(!0);n.status==400&&n.responseText&&t.deleteErrorAdditionalDetails(n.responseText)})}}})(t.ProjectManagement=t.ProjectManagement||{})})(n.Administration=n.Administration||{})})(window.GoNorth=window.GoNorth||{});